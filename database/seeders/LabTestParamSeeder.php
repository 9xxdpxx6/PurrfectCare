<?php

namespace Database\Seeders;

use App\Models\LabTestParam;
use App\Models\LabTestType;
use App\Models\Unit;
use Illuminate\Database\Seeder;

class LabTestParamSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $params = [
            // Общий анализ крови (ОАК)
            [
                'name' => 'Гемоглобин',
                'description' => 'Уровень гемоглобина в крови',
                'lab_test_type' => 'Общий анализ крови (ОАК)',
                'unit' => 'г/л'
            ],
            [
                'name' => 'Эритроциты',
                'description' => 'Количество эритроцитов',
                'lab_test_type' => 'Общий анализ крови (ОАК)',
                'unit' => '10^12/л'
            ],
            [
                'name' => 'Лейкоциты',
                'description' => 'Количество лейкоцитов',
                'lab_test_type' => 'Общий анализ крови (ОАК)',
                'unit' => '10^9/л'
            ],
            [
                'name' => 'Тромбоциты',
                'description' => 'Количество тромбоцитов',
                'lab_test_type' => 'Общий анализ крови (ОАК)',
                'unit' => '10^9/л'
            ],
            [
                'name' => 'СОЭ',
                'description' => 'Скорость оседания эритроцитов',
                'lab_test_type' => 'Общий анализ крови (ОАК)',
                'unit' => 'мм/ч'
            ],

            // Биохимический анализ крови
            [
                'name' => 'АЛТ',
                'description' => 'Аланинаминотрансфераза',
                'lab_test_type' => 'Биохимический анализ крови',
                'unit' => 'Ед/л'
            ],
            [
                'name' => 'АСТ',
                'description' => 'Аспартатаминотрансфераза',
                'lab_test_type' => 'Биохимический анализ крови',
                'unit' => 'Ед/л'
            ],
            [
                'name' => 'Билирубин общий',
                'description' => 'Общий билирубин',
                'lab_test_type' => 'Биохимический анализ крови',
                'unit' => 'мкмоль/л'
            ],
            [
                'name' => 'Креатинин',
                'description' => 'Уровень креатинина',
                'lab_test_type' => 'Биохимический анализ крови',
                'unit' => 'мкмоль/л'
            ],
            [
                'name' => 'Мочевина',
                'description' => 'Уровень мочевины',
                'lab_test_type' => 'Биохимический анализ крови',
                'unit' => 'ммоль/л'
            ],

            // Общий анализ мочи
            [
                'name' => 'Белок',
                'description' => 'Наличие белка в моче',
                'lab_test_type' => 'Общий анализ мочи',
                'unit' => 'г/л'
            ],
            [
                'name' => 'Глюкоза',
                'description' => 'Уровень глюкозы в моче',
                'lab_test_type' => 'Общий анализ мочи',
                'unit' => 'ммоль/л'
            ],
            [
                'name' => 'Лейкоциты в моче',
                'description' => 'Количество лейкоцитов в моче',
                'lab_test_type' => 'Общий анализ мочи',
                'unit' => 'в поле зрения'
            ],

            // Анализ кала на яйца гельминтов
            [
                'name' => 'Яйца гельминтов',
                'description' => 'Наличие яиц гельминтов',
                'lab_test_type' => 'Анализ кала на яйца гельминтов',
                'unit' => null
            ],

            // Анализ кала на скрытую кровь
            [
                'name' => 'Скрытая кровь',
                'description' => 'Наличие скрытой крови в кале',
                'lab_test_type' => 'Анализ кала на скрытую кровь',
                'unit' => null
            ],

            // Анализ на гормоны щитовидной железы
            [
                'name' => 'Т4',
                'description' => 'Тироксин',
                'lab_test_type' => 'Анализ на гормоны щитовидной железы',
                'unit' => 'пмоль/л'
            ],
            [
                'name' => 'Т3',
                'description' => 'Трийодтиронин',
                'lab_test_type' => 'Анализ на гормоны щитовидной железы',
                'unit' => 'пмоль/л'
            ],
            [
                'name' => 'ТТГ',
                'description' => 'Тиреотропный гормон',
                'lab_test_type' => 'Анализ на гормоны щитовидной железы',
                'unit' => 'мкМЕ/мл'
            ],

            // Анализ на кортизол
            [
                'name' => 'Кортизол',
                'description' => 'Уровень кортизола',
                'lab_test_type' => 'Анализ на кортизол',
                'unit' => 'нмоль/л'
            ],

            // Анализ на инсулин и глюкозу
            [
                'name' => 'Глюкоза',
                'description' => 'Уровень глюкозы в крови',
                'lab_test_type' => 'Анализ на инсулин и глюкозу',
                'unit' => 'ммоль/л'
            ],
            [
                'name' => 'Инсулин',
                'description' => 'Уровень инсулина',
                'lab_test_type' => 'Анализ на инсулин и глюкозу',
                'unit' => 'мкЕд/мл'
            ],

            // Анализ на аллергены (IgE)
            [
                'name' => 'IgE общий',
                'description' => 'Общий иммуноглобулин E',
                'lab_test_type' => 'Анализ на аллергены (IgE)',
                'unit' => 'МЕ/мл'
            ],

            // Цитологическое исследование
            [
                'name' => 'Клеточный состав',
                'description' => 'Клеточный состав образца',
                'lab_test_type' => 'Цитологическое исследование',
                'unit' => null
            ],

            // Бактериологический посев с определением чувствительности
            [
                'name' => 'Бактериальная культура',
                'description' => 'Выделенная бактериальная культура',
                'lab_test_type' => 'Бактериологический посев с определением чувствительности',
                'unit' => null
            ],

            // ПЦР диагностика вирусных инфекций
            [
                'name' => 'Вирусная ДНК/РНК',
                'description' => 'Наличие вирусной ДНК/РНК',
                'lab_test_type' => 'ПЦР диагностика вирусных инфекций',
                'unit' => null
            ],
            [
                'name' => 'Антитела IgM',
                'description' => 'Уровень антител IgM',
                'lab_test_type' => 'ПЦР диагностика вирусных инфекций',
                'unit' => 'МЕ/мл'
            ],

            // Микроскопическое исследование на грибки
            [
                'name' => 'Споры грибков',
                'description' => 'Наличие спор грибков',
                'lab_test_type' => 'Микроскопическое исследование на грибки',
                'unit' => null
            ],

            // Посев на грибки
            [
                'name' => 'Грибковая культура',
                'description' => 'Культура грибков',
                'lab_test_type' => 'Посев на грибки',
                'unit' => null
            ],

            // Анализ на эктопаразитов
            [
                'name' => 'Эктопаразиты',
                'description' => 'Наличие эктопаразитов',
                'lab_test_type' => 'Анализ на эктопаразитов',
                'unit' => null
            ],

            // Анализ на эндопаразитов
            [
                'name' => 'Эндопаразиты',
                'description' => 'Наличие эндопаразитов',
                'lab_test_type' => 'Анализ на эндопаразитов',
                'unit' => null
            ],

            // Анализ на онкомаркеры
            [
                'name' => 'АФП',
                'description' => 'Альфа-фетопротеин',
                'lab_test_type' => 'Анализ на онкомаркеры',
                'unit' => 'нг/мл'
            ],
            [
                'name' => 'ПСА',
                'description' => 'Простат-специфический антиген',
                'lab_test_type' => 'Анализ на онкомаркеры',
                'unit' => 'нг/мл'
            ],

            // Серологическая диагностика инфекций
            [
                'name' => 'Антиген',
                'description' => 'Наличие антигена',
                'lab_test_type' => 'Серологическая диагностика инфекций',
                'unit' => null
            ],
            [
                'name' => 'Антитела',
                'description' => 'Уровень антител',
                'lab_test_type' => 'Серологическая диагностика инфекций',
                'unit' => 'МЕ/мл'
            ],

            // Анализ на аутоиммунные заболевания
            [
                'name' => 'АНФ',
                'description' => 'Антинуклеарные антитела',
                'lab_test_type' => 'Анализ на аутоиммунные заболевания',
                'unit' => null
            ],
            [
                'name' => 'Ревматоидный фактор',
                'description' => 'Ревматоидный фактор',
                'lab_test_type' => 'Анализ на аутоиммунные заболевания',
                'unit' => 'МЕ/мл'
            ]
        ];

        foreach ($params as $param) {
            $labTestType = LabTestType::where('name', $param['lab_test_type'])->first();
            $unit = null;
            
            if ($param['unit']) {
                $unit = Unit::where('symbol', $param['unit'])->first();
            }

            if ($labTestType) {
                LabTestParam::firstOrCreate(
                    [
                        'name' => $param['name'],
                        'lab_test_type_id' => $labTestType->id
                    ],
                    [
                        'description' => $param['description'],
                        'unit_id' => $unit ? $unit->id : null
                    ]
                );
            }
        }
    }
} 